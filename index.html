<script>
let orderData = {};

function goToPayment() {
    const customName = (document.getElementById('customName')?.value || '').trim() || 'Not provided';
    const bodyColorInput = document.querySelector('input[name="bodyColor"]:checked');
    const gripColorInput = document.querySelector('input[name="gripColor"]:checked');
    const phone = (document.getElementById('phone')?.value || '').trim() || 'Not provided';
    const email = (document.getElementById('email')?.value || '').trim() || 'Not provided';
    const address = (document.getElementById('address')?.value || '').trim() || 'Not provided';

    if (!bodyColorInput || !gripColorInput) {
        alert('Please select both Body and Grip colors!');
        return;
    }

    orderData = {
        customName: customName,
        bodyColor: bodyColorInput?.value || 'Not provided',
        gripColor: gripColorInput?.value || 'Not provided',
        phone: phone,
        email: email,
        address: address
    };

    // Update summary safely
    document.getElementById('summaryName').textContent = orderData.customName;
    document.getElementById('summaryBody').textContent = orderData.bodyColor;
    document.getElementById('summaryGrip').textContent = orderData.gripColor;
    document.getElementById('summaryPhone').textContent = orderData.phone;
    document.getElementById('summaryEmail').textContent = orderData.email;
    document.getElementById('summaryAddress').textContent = orderData.address;

    document.getElementById('page1').classList.remove('active');
    document.getElementById('page2').classList.add('active');
    window.scrollTo(0, 0);
}

function completeOrder() {
    const paymentMethodInput = document.querySelector('input[name="payment"]:checked');
    if (!paymentMethodInput) {
        alert('Please select a payment method!');
        return;
    }

    orderData.paymentMethod = paymentMethodInput?.value || 'Not provided';

    if (orderData.paymentMethod === 'UPI') {
        document.getElementById('page2').classList.remove('active');
        document.getElementById('page3').classList.add('active');
    } else {
        sendOrderEmail();
        document.getElementById('page2').classList.remove('active');
        document.getElementById('page4').classList.add('active');
    }
    window.scrollTo(0, 0);
}

function confirmUPIPayment() {
    document.getElementById('page3').classList.remove('active');
    document.getElementById('page4').classList.add('active');
    window.scrollTo(0, 0);
    setTimeout(sendOrderEmail, 500);
}

function sendOrderEmail() {
    const orderDetails = {
        ...orderData,
        orderDate: new Date().toLocaleString()
    };

    fetch('https://script.google.com/macros/s/AKfycbxzrAgwt46ulQpMWz2xIoLPFfi6oufbhWJ78z2Y62y1BRl6-GnJMWIPvzZvTrM0iO4D/exec', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(orderDetails)
    })
    .then(() => console.log('Order sent successfully!'))
    .catch((error) => console.error('Error sending order:', error));
}

// Payment selection effect
document.querySelectorAll('.payment-option').forEach(option => {
    option.addEventListener('click', function() {
        document.querySelectorAll('.payment-option').forEach(opt => opt.classList.remove('selected'));
        this.classList.add('selected');
        const radio = this.querySelector('input[type="radio"]');
        if (radio) radio.checked = true;
    });
});
</script>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Custom Pens - Personalized Writing Instruments</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:'Segoe UI',Tahoma, Geneva, Verdana, sans-serif;
         background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
         min-height:100vh;padding:20px}
    .hero-section{text-align:center;color:#fff;padding:40px 20px;max-width:1200px;margin:0 auto 30px}
    .hero-section h1{font-size:3.5em;margin-bottom:15px;text-shadow:2px 2px 4px rgba(0,0,0,.3)}
    .hero-section p{font-size:1.3em;text-shadow:1px 1px 2px rgba(0,0,0,.3)}
    .pen-showcase{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;max-width:1200px;margin:0 auto 40px;padding:0 20px}
    .pen-card{background:#fff;border-radius:15px;padding:20px;box-shadow:0 10px 30px rgba(0,0,0,.2);text-align:center;transition:transform .3s ease}
    .pen-card:hover{transform:translateY(-10px) scale(1.05)}
    .pen-image{font-size:80px;margin-bottom:10px}
    .container{background:#fff;border-radius:20px;box-shadow:0 20px 60px rgba(0,0,0,.3);max-width:900px;width:100%;padding:36px;margin:0 auto}
    .page{display:none}.page.active{display:block}
    h2{color:#667eea;margin-bottom:10px;font-size:2em}
    .subtitle{color:#666;margin-bottom:18px;font-size:.95em}
    .form-group{margin-bottom:20px}
    label.main-label{display:block;margin-bottom:8px;color:#333;font-weight:700;font-size:1.05em}
    input[type="text"],input[type="email"],input[type="tel"],input[type="number"]{
      width:100%;padding:12px 14px;border:2px solid #e0e0e0;border-radius:10px;font-size:15px;
    }
    .color-selector{display:grid;grid-template-columns:repeat(auto-fill,minmax(90px,1fr));gap:14px;margin-top:12px}
    .color-option{text-align:center;cursor:pointer;user-select:none}
    .color-option input[type="radio"]{display:none}
    .color-box-wrapper{
      position:relative;padding-bottom:100%;border-radius:12px;overflow:hidden;
      transition:all .18s ease;border:3px solid #eaeaea;background:#fff;
    }
    .color-option:hover .color-box-wrapper{transform:scale(1.06);border-color:#667eea}
    .color-option input[type="radio"]:checked + .color-box-wrapper{
      border:4px solid #333;transform:scale(1.05);box-shadow:0 8px 20px rgba(0,0,0,.18)
    }
    .color-box{position:absolute;top:0;left:0;width:100%;height:100%}
    .color-name{margin-top:8px;font-size:.92em;color:#222;font-weight:700}
    .inline-row{display:flex;gap:12px;align-items:center}
    .small-radio{display:inline-flex;align-items:center;gap:8px;margin-right:12px}
    button.primary{width:100%;padding:16px 18px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;border:none;border-radius:12px;font-size:18px;font-weight:800;cursor:pointer;margin-top:8px}
    .order-summary{background:linear-gradient(135deg,#f8f9ff 0%,#e8ebff 100%);padding:18px;border-radius:12px;margin-bottom:18px;border:2px solid #667eea}
    .summary-item{display:flex;justify-content:space-between;margin-bottom:10px;padding-bottom:8px;border-bottom:1px dashed rgba(102,126,234,.12)}
    .muted{color:#666}
    /* responsive tweaks */
    @media (max-width:520px){
      .color-selector{grid-template-columns:repeat(3,1fr)}
    }
  </style>
</head>
<body>
  <div class="hero-section">
    <h1>‚úíÔ∏è Custom Pens</h1>
    <p>Design Your Perfect Personalized Writing Instrument</p>
  </div>

  <div class="pen-showcase">
    <div class="pen-card"><div class="pen-image">üñäÔ∏è</div><h3>Classic</h3><p>Elegant & Professional</p></div>
    <div class="pen-card"><div class="pen-image">‚úíÔ∏è</div><h3>Premium</h3><p>Luxury Feel</p></div>
    <div class="pen-card"><div class="pen-image">üñãÔ∏è</div><h3>Executive</h3><p>Business Style</p></div>
    <div class="pen-card"><div class="pen-image">‚úçÔ∏è</div><h3>Custom</h3><p>Your Design</p></div>
  </div>

  <div class="container">
    <!-- PAGE 1 -->
    <div id="page1" class="page active">
      <h2>üé® Customize Your Pen</h2>
      <p class="subtitle">Make it uniquely yours!</p>

      <form id="orderForm" onsubmit="return false;">
        <div class="form-group">
          <label class="main-label" for="customName">Custom Name on Pen *</label>
          <input type="text" id="customName" required placeholder="Enter name to be printed">
        </div>

        <!-- Body Color (rainbow + gold + silver) -->
        <div class="form-group">
          <label class="main-label">Body Color *</label>
          <div class="color-selector" id="bodyColors">
            <label class="color-option"><input type="radio" name="bodyColor" value="Red" required><div class="color-box-wrapper"><div class="color-box" style="background:#FF0000"></div></div><div class="color-name">Red</div></label>
            <label class="color-option"><input type="radio" name="bodyColor" value="Orange"><div class="color-box-wrapper"><div class="color-box" style="background:#FF7F00"></div></div><div class="color-name">Orange</div></label>
            <label class="color-option"><input type="radio" name="bodyColor" value="Yellow"><div class="color-box-wrapper"><div class="color-box" style="background:#FFD600"></div></div><div class="color-name">Yellow</div></label>
            <label class="color-option"><input type="radio" name="bodyColor" value="Green"><div class="color-box-wrapper"><div class="color-box" style="background:#00C853"></div></div><div class="color-name">Green</div></label>
            <label class="color-option"><input type="radio" name="bodyColor" value="Blue"><div class="color-box-wrapper"><div class="color-box" style="background:#1E3FFF"></div></div><div class="color-name">Blue</div></label>
            <label class="color-option"><input type="radio" name="bodyColor" value="Indigo"><div class="color-box-wrapper"><div class="color-box" style="background:#4B0082"></div></div><div class="color-name">Indigo</div></label>
            <label class="color-option"><input type="radio" name="bodyColor" value="Violet"><div class="color-box-wrapper"><div class="color-box" style="background:#9400D3"></div></div><div class="color-name">Violet</div></label>
            <label class="color-option"><input type="radio" name="bodyColor" value="Gold"><div class="color-box-wrapper"><div class="color-box" style="background:linear-gradient(135deg,#FFD700,#FFA500)"></div></div><div class="color-name">Gold</div></label>
            <label class="color-option"><input type="radio" name="bodyColor" value="Silver"><div class="color-box-wrapper"><div class="color-box" style="background:linear-gradient(135deg,#C0C0C0,#E8E8E8)"></div></div><div class="color-name">Silver</div></label>
          </div>
        </div>

        <!-- Grip Color (same choices) -->
        <div class="form-group">
          <label class="main-label">Grip Color *</label>
          <div class="color-selector" id="gripColors">
            <label class="color-option"><input type="radio" name="gripColor" value="Red" required><div class="color-box-wrapper"><div class="color-box" style="background:#FF0000"></div></div><div class="color-name">Red</div></label>
            <label class="color-option"><input type="radio" name="gripColor" value="Orange"><div class="color-box-wrapper"><div class="color-box" style="background:#FF7F00"></div></div><div class="color-name">Orange</div></label>
            <label class="color-option"><input type="radio" name="gripColor" value="Yellow"><div class="color-box-wrapper"><div class="color-box" style="background:#FFD600"></div></div><div class="color-name">Yellow</div></label>
            <label class="color-option"><input type="radio" name="gripColor" value="Green"><div class="color-box-wrapper"><div class="color-box" style="background:#00C853"></div></div><div class="color-name">Green</div></label>
            <label class="color-option"><input type="radio" name="gripColor" value="Blue"><div class="color-box-wrapper"><div class="color-box" style="background:#1E3FFF"></div></div><div class="color-name">Blue</div></label>
            <label class="color-option"><input type="radio" name="gripColor" value="Indigo"><div class="color-box-wrapper"><div class="color-box" style="background:#4B0082"></div></div><div class="color-name">Indigo</div></label>
            <label class="color-option"><input type="radio" name="gripColor" value="Violet"><div class="color-box-wrapper"><div class="color-box" style="background:#9400D3"></div></div><div class="color-name">Violet</div></label>
            <label class="color-option"><input type="radio" name="gripColor" value="Gold"><div class="color-box-wrapper"><div class="color-box" style="background:linear-gradient(135deg,#FFD700,#FFA500)"></div></div><div class="color-name">Gold</div></label>
            <label class="color-option"><input type="radio" name="gripColor" value="Silver"><div class="color-box-wrapper"><div class="color-box" style="background:linear-gradient(135deg,#C0C0C0,#E8E8E8)"></div></div><div class="color-name">Silver</div></label>
            <label class="color-option"><input type="radio" name="gripColor" value="Black"><div class="color-box-wrapper"><div class="color-box" style="background:#000000"></div></div><div class="color-name" style="color:#000">Black</div></label>
            <label class="color-option"><input type="radio" name="gripColor" value="White"><div class="color-box-wrapper"><div class="color-box" style="background:#FFFFFF;border:1px solid #eee"></div></div><div class="color-name">White</div></label>
          </div>
        </div>

        <!-- Ink Color -->
        <div class="form-group">
          <label class="main-label">Ink Color *</label>
          <div class="inline-row">
            <label class="small-radio"><input type="radio" name="inkColor" value="Blue" required> Blue</label>
            <label class="small-radio"><input type="radio" name="inkColor" value="Black"> Black</label>
          </div>
        </div>

        <div class="form-group"><label class="main-label" for="phone">Phone Number *</label><input type="tel" id="phone" required placeholder="+91 98765 43210"></div>
        <div class="form-group"><label class="main-label" for="email">Email Address *</label><input type="email" id="email" required placeholder="your.email@example.com"></div>
        <div class="form-group"><label class="main-label" for="address">Delivery Address *</label><input type="text" id="address" required placeholder="Enter your full address"></div>

        <div class="form-group">
          <label class="main-label" for="qty">Quantity</label>
          <input type="number" id="qty" min="1" value="1" style="width:120px">
        </div>

        <button class="primary" type="button" onclick="goToPayment()">Confirm Order ‚Üí</button>
      </form>
    </div>

    <!-- PAGE 2 -->
    <div id="page2" class="page">
      <h2>üí≥ Payment & Summary</h2>

      <div class="order-summary">
        <div class="summary-item"><span class="muted">Custom Name:</span><span id="summaryName">-</span></div>
        <div class="summary-item"><span class="muted">Body Color:</span><span id="summaryBody">-</span></div>
        <div class="summary-item"><span class="muted">Grip Color:</span><span id="summaryGrip">-</span></div>
        <div class="summary-item"><span class="muted">Ink Color:</span><span id="summaryInk">-</span></div>
        <div class="summary-item"><span class="muted">Quantity:</span><span id="summaryQty">-</span></div>
        <div class="summary-item"><span class="muted">Phone:</span><span id="summaryPhone">-</span></div>
        <div class="summary-item"><span class="muted">Email:</span><span id="summaryEmail">-</span></div>
        <div class="summary-item"><span class="muted">Address:</span><span id="summaryAddress">-</span></div>
      </div>

      <label class="payment-option"><input type="radio" name="payment" value="UPI" required> UPI Payment</label>
      <label class="payment-option"><input type="radio" name="payment" value="Cash on Delivery"> Cash on Delivery</label>

      <button class="primary" type="button" onclick="completeOrder()">Complete Order ‚úì</button>
    </div>

    <!-- PAGE 3: UPI -->
    <div id="page3" class="page">
      <h2>Scan & Pay</h2>
      <p class="muted">Scan QR code to pay ‚Çπ90 (example)</p>

      <div style="text-align:center;margin:18px 0;">
        <div style="background:linear-gradient(135deg,#00BAF2 0%,#00A7E5 100%);padding:20px;border-radius:16px;display:inline-block;box-shadow:0 15px 40px rgba(0,0,0,.12)">
          <div style="background:white;padding:18px;border-radius:12px;margin-bottom:12px">
            <div style="color:#00BAF2;font-size:1.6em;font-weight:700;margin-bottom:8px">paytm</div>
            <!-- local QR image path (keeps your uploaded QR) -->
            <img src="/mnt/data/Screenshot 2025-11-22 at 11.46.59 PM.png" alt="Paytm QR" style="width:240px;height:240px;border-radius:10px;display:block;margin:0 auto 10px">
            <div style="margin-top:8px;color:#333;font-size:1em;font-weight:600">‚ö° 9392383055@pthfc</div>
          </div>
        </div>
      </div>

      <p class="muted">Your pen will be delivered in 3‚Äì5 business days.</p>
      <div style="margin-top:12px">
        <button class="primary" onclick="finishOrder()">Finish Order</button>
      </div>
    </div>

    <!-- PAGE 4: THANK YOU -->
    <div id="page4" class="page">
      <h2>Order Complete üéâ</h2>
      <p>Thank you! Your pen is on the way. We'll contact you at the provided email/phone.</p>
    </div>
  </div>

  <!-- GOOGLE SCRIPT + LOGIC -->
  <script>
    // <<< Replace with your deployed Google Apps Script web app URL (you already gave this earlier) >>>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzoeh6ltmbewred-Gd--1fSFHouUHgflFUuuHIPRXYYrKf_ck7dRiND2mJFJRjgK7H-/exec";

    let order = {};

    function showPage(id) {
      document.querySelectorAll(".page").forEach(p => p.classList.remove("active"));
      const el = document.getElementById(id);
      if (el) el.classList.add("active");
      window.scrollTo(0,0);
    }

    function goToPayment() {
      order.customerName = document.getElementById("customName").value.trim();
      order.penBodyColor = document.querySelector("input[name='bodyColor']:checked")?.value;
      order.gripColor = document.querySelector("input[name='gripColor']:checked")?.value;
      order.selectedInk = document.querySelector("input[name='inkColor']:checked")?.value;
      order.phoneNumber = document.getElementById("phone").value.trim();
      order.customerEmail = document.getElementById("email").value.trim();
      order.address = document.getElementById("address").value.trim();
      order.selectedQuantity = document.getElementById("qty").value || "1";

      if (!order.customerName || !order.penBodyColor || !order.gripColor || !order.selectedInk || !order.phoneNumber || !order.customerEmail || !order.address) {
        alert("Please fill all required fields and choose colors/ink.");
        return;
      }

      // update summary display
      document.getElementById("summaryName").innerText = order.customerName;
      document.getElementById("summaryBody").innerText = order.penBodyColor;
      document.getElementById("summaryGrip").innerText = order.gripColor;
      document.getElementById("summaryInk").innerText = order.selectedInk;
      document.getElementById("summaryQty").innerText = order.selectedQuantity;
      document.getElementById("summaryPhone").innerText = order.phoneNumber;
      document.getElementById("summaryEmail").innerText = order.customerEmail;
      document.getElementById("summaryAddress").innerText = order.address;

      showPage("page2");
    }

    function completeOrder() {
      const payment = document.querySelector("input[name='payment']:checked");
      if (!payment) { alert("Select a payment method."); return; }
      order.paymentMethod = payment.value;

      if (order.paymentMethod === "UPI") {
        // show UPI scan page first (customer pays), then they press Finish -> sends to Google
        showPage("page3");
      } else {
        // COD: immediately send to Google script and show thank you
        sendToGoogle();
        showPage("page4");
      }
    }

    function finishOrder() {
      // Called after they scan & pay
      sendToGoogle();
      showPage("page4");
    }

    // send to Apps Script (which will email you & customer)
    function sendToGoogle() {
      // ensure quantity is at least 1
      if (!order.selectedQuantity) order.selectedQuantity = "1";

      fetch(SCRIPT_URL, {
        method: "POST",
        body: JSON.stringify(order),
        mode: "cors",
        headers: {
          "Content-Type": "application/json"
        }
      })
      .then(response => response.json ? response.json() : null)
      .then(data => {
        console.log("Sent to Google Script:", data);
        // optionally clear local storage or form
      })
      .catch(err => {
        console.error("Error sending order to script:", err);
        // still show confirmation so user doesn't get stuck
      });
    }
  </script>
</body>
</html>
